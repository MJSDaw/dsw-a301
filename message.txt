-- PostgreSQL SQL Dump
-- Versión de PostgreSQL: 17

BEGIN;

-- Creación de la base de datos si no existe
CREATE DATABASE campus
    WITH 
    ENCODING = 'UTF8'
    LC_COLLATE = 'C'
    LC_CTYPE = 'C'
    CONNECTION LIMIT = -1;

-- Estructura de la tabla 'alumnado'
DROP TABLE IF EXISTS alumnado;
CREATE TABLE IF NOT EXISTS alumnado (
    dni VARCHAR(9) PRIMARY KEY,
    nombre TEXT NOT NULL,
    apellidos TEXT NOT NULL,
    email TEXT NOT NULL UNIQUE
);

-- Volcado de datos para la tabla 'alumnado'
INSERT INTO alumnado (dni, nombre, apellidos, email) VALUES
('32148888H', 'Hernando', 'Hernández', 'hernandohernandez@gmail.com'),
('34666576R', 'Roberto', 'Martínez', 'robertomartinez@gmail.com'),
('42354354H', 'Armando', 'Guerra', 'armandoguerra@gmail.com'),
('54129865P', 'Patricia', 'López', 'patricialopez@gmail.com'),
('54354343I', 'Inés', 'Romero', 'inesromero@gmail.com'),
('75657554F', 'Francisca', 'Moreno', 'franciscamoreno@gmail.com'),
('76345342T', 'Jose', 'Fernandez', 'josefernandez@gmail.com'),
('76543576Y', 'Yeray', 'Gutiérrez', 'yeraygutierrez@gmail.com');

-- Estructura de la tabla 'aulasvirtuales'
DROP TABLE IF EXISTS aulasvirtuales;
CREATE TABLE IF NOT EXISTS aulasvirtuales (
    id SERIAL PRIMARY KEY,
    nombrecorto TEXT NOT NULL,
    nombrelargo TEXT NOT NULL
);

-- Volcado de datos para la tabla 'aulasvirtuales'
INSERT INTO aulasvirtuales (nombrecorto, nombrelargo) VALUES
('DWS', 'Desarrollo web en entorno servidor'),
('DEW', 'Desarrollo web en entorno cliente');

-- Estructura de la tabla 'matriculas'
DROP TABLE IF EXISTS matriculas;
CREATE TABLE IF NOT EXISTS matriculas (
    id_aula INT NOT NULL,
    dni VARCHAR(9) NOT NULL,
    PRIMARY KEY (id_aula, dni),
    CONSTRAINT fk_matricula_alumnado FOREIGN KEY (dni) REFERENCES alumnado (dni) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT fk_matricula_aulas_virtuales FOREIGN KEY (id_aula) REFERENCES aulasvirtuales (id) ON DELETE CASCADE ON UPDATE CASCADE
);

-- Volcado de datos para la tabla 'matriculas'
INSERT INTO matriculas (id_aula, dni) VALUES
(1, '32148888H'),
(1, '34666576R'),
(1, '42354354H'),
(1, '54129865P'),
(1, '54354343I'),
(2, '32148888H'),
(2, '34666576R'),
(2, '75657554F'),
(2, '76345342T'),
(2, '76543576Y');

COMMIT;
